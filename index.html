<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SERES - Archivio Attrezzature</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header">
        <button class="menu-toggle" id="menuToggle">‚ò∞</button>
        <h1>üîß SERES - Archivio Attrezzature</h1>
        <div class="search-section">
            <span class="search-text" id="searchText">Ricerca</span>
            <button class="search-icon" id="searchToggle">üîç</button>
        </div>
    </div>

    <!-- Search Overlay -->
    <div class="search-overlay" id="searchOverlay">
        <div class="search-container">
            <div class="search-header">
                <h3>üîç Ricerca Attrezzature</h3>
                <button class="search-close" id="searchClose">‚úï</button>
            </div>
            <input type="text" class="search-bar" id="searchInput" placeholder="Cerca per codice, tipo, marca o ubicazione..." style="margin-bottom: 0;">
        </div>
    </div>

    <!-- Menu Slide -->
    <div class="menu-overlay" id="menuOverlay"></div>
    <div class="slide-menu" id="slideMenu">
        <div class="menu-header">
            <h3>Menu</h3>
            <button class="menu-close" id="menuClose">‚úï</button>
        </div>
        <div class="menu-content">
            <h4 style="margin: 25px 0 15px; color: #333;">‚öôÔ∏è Azioni</h4>
            <button class="menu-item" id="btnAddEquipment">
                üõ†Ô∏è Nuova Attrezzatura
            </button>
            <button class="menu-item" id="btnRefresh">
                üîÑ Aggiorna Dati
            </button>
            <h4 style="margin: 25px 0 15px; color: #333;">‚ÑπÔ∏è Info</h4>
            <button class="menu-item" id="btnAbout">
                üìñ Guida all'uso
            </button>
        </div>
    </div>

    <!-- About Modal -->
    <div class="about-modal" id="aboutModal">
        <button class="about-close" id="aboutClose">‚úï</button>
        <h2>üì± Gestione Attrezzature SERES</h2>
        
        <h3>üéØ Scopo dell'applicazione</h3>
        <p>Questa applicazione permette di gestire e tracciare tutte le attrezzature SERES, mantenendo uno storico dei movimenti e facilitando la ricerca degli strumenti.</p>

        <h3>üîç Come utilizzare l'app</h3>
        <ul>
            <li><strong>Visualizzazione:</strong> √à possibile visualizzare le attrezzature per ubicazione, categoria o tipo utilizzando il menu in alto.</li>
            <li><strong>Ricerca:</strong> Usa la barra di ricerca per trovare rapidamente un'attrezzatura specifica. La ricerca funziona su codice, tipo, marca/modello, ubicazione e categoria.</li>
            <li><strong>Dettagli:</strong> Clicca su un'attrezzatura per vedere tutti i dettagli e lo storico dei movimenti.</li>
            <li><strong>Spostamenti:</strong> Nella vista dettaglio, puoi registrare lo spostamento di un'attrezzatura in una nuova ubicazione.</li>
        </ul>
        
        <h3>‚ûï Gestione dati</h3>
        <ul>
            <li><strong>Nuova Ubicazione:</strong> Puoi aggiungere una nuova ubicazione durante lo spostamento di un'attrezzatura.</li>
            <li><strong>Nuova Attrezzatura:</strong> Registra una nuova attrezzatura nel sistema.</li>
            <li><strong>Aggiorna Dati:</strong> Sincronizza i dati con il database.</li>
        </ul>

        <h3>üí° Suggerimenti</h3>
        <ul>
            <li>Usa il pulsante di ricerca per filtrare rapidamente le attrezzature.</li>
            <li>Controlla sempre l'ubicazione attuale prima di cercare un'attrezzatura.</li>
            <li>Registra sempre i movimenti delle attrezzature per mantenere uno storico accurato.</li>
        </ul>
    </div>
    
    <div class="container">
        <div class="view-content" id="viewContent">
            <div class="loading">
                <p>üîÑ Caricamento dati dal database...</p>
                <div style="margin-top: 20px;">
                    <div style="width: 100%; background: #e0e0e0; border-radius: 10px; overflow: hidden;">
                        <div id="loadingBar" style="width: 0%; height: 4px; background: #8B2E1A; transition: width 0.3s ease;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-item active" id="navUbicazione" data-view="ubicazione">
            <div class="nav-icon">üìç</div>
            <div class="nav-label">Ubicazione</div>
        </button>
        <button class="nav-item" id="navCategoria" data-view="categoria">
            <div class="nav-icon">üìÇ</div>
            <div class="nav-label">Categoria</div>
        </button>
        <button class="nav-item" id="navTipo" data-view="tipo">
            <div class="nav-icon">üîß</div>
            <div class="nav-label">Tipo</div>
        </button>
    </div>

    <!-- Modal Dettaglio Attrezzatura -->
    <div id="detailModal" class="modal">
        <div class="modal-content detail-modal">
            <div class="modal-header">
                <h2>Dettaglio Attrezzatura</h2>
                <button class="modal-close" id="closeDetailModal">‚úï</button>
            </div>
            
            <!-- Info Principali -->
            <div class="detail-section">
                <div class="detail-info">
                    <div class="info-group">
                        <label>Codice:</label>
                        <span id="detailCodice"></span>
                    </div>
                    <div class="info-group">
                        <label>Categoria:</label>
                        <span id="detailCategoria"></span>
                    </div>
                    <div class="info-group">
                        <label>Tipo:</label>
                        <span id="detailTipo"></span>
                    </div>
                    <div class="info-group">
                        <label>Marca/Modello:</label>
                        <span id="detailMarca"></span>
                    </div>
                    <div class="info-group">
                        <label>Ubicazione Attuale:</label>
                        <span id="detailUbicazione"></span>
                    </div>
                </div>
            </div>

            <!-- Form Note -->
            <div class="detail-section edit-section">
                <h3>Aggiungi Nota</h3>                <form id="updateNotesForm" class="detail-form">
                    <div class="form-group">
                        <label for="detailNote">Nuova Nota:</label>
                        <textarea id="detailNote" class="form-input note-textarea" rows="2" placeholder="Scrivi una nuova nota..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="noteUserName">Il tuo nome:</label>
                        <input type="text" id="noteUserName" class="form-input" required placeholder="INSERISCI IL TUO NOME" style="text-transform: uppercase;">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="primary-button">üíæ Salva Nota</button>
                    </div>
                </form>
            </div>

            <!-- Storico Note -->
            <div class="detail-section history-section">
                <h3>Storico Note</h3>
                <div id="notesHistory" class="notes-list">
                    <p style="color: #666; font-style: italic;">Caricamento storico note...</p>
                </div>
            </div>

            <!-- Sezione Spostamento -->
            <div class="detail-section move-section">
                <h3>Sposta Attrezzatura</h3>                <form id="moveForm" class="detail-form">
                    <input type="hidden" id="currentLocation">
                    <div class="form-group">
                        <label for="newLocation">Nuova Ubicazione:</label>
                        <div class="select-with-add" id="existingLocationDiv">
                            <select id="newLocation" class="form-select" required>
                                <option value="">Seleziona ubicazione...</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="isNewLocationCheckbox">
                            Nuova Ubicazione
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="userName">Il tuo nome:</label>
                        <input type="text" id="userName" class="form-input" required placeholder="INSERISCI IL TUO NOME" style="text-transform: uppercase;">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="primary-button">üì¶ Sposta</button>
                    </div>
                </form>
            </div>

            <!-- Storico Movimenti -->
            <div class="detail-section history-section">
                <h3>Storico Movimenti</h3>
                <div id="movementHistory" class="movement-list">
                    <p style="color: #666; font-style: italic;">Caricamento storico...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Nuova Attrezzatura -->
    <div class="modal" id="newEquipmentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üõ†Ô∏è Nuova Attrezzatura</h3>
                <button class="modal-close" id="newEquipmentClose">‚úï</button>
            </div>
            <div class="modal-body">
                <form id="newEquipmentForm">
                    <div class="form-group">
                        <label for="categoria">Categoria:</label>
                        <div class="select-with-add" id="existingCategoryDiv">
                            <select id="categoria" name="categoria" class="form-select" required>
                                <option value="">Seleziona categoria...</option>
                            </select>
                        </div>
                        <input type="text" id="newCategoryInput" name="newCategory"
                               style="display: none; text-transform: uppercase;"
                               placeholder="Inserisci nuova categoria"
                               class="form-input">
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="isNewCategoryCheckbox">
                            Nuova Categoria
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="tipo">Tipo:</label>
                        <div class="select-with-add" id="existingTypeDiv">
                            <select id="tipo" name="tipo" class="form-select" required>
                                <option value="">Seleziona tipo...</option>
                            </select>
                        </div>
                        <input type="text" id="newTypeInput" name="newType"
                               style="display: none; text-transform: uppercase;"
                               placeholder="Inserisci nuovo tipo"
                               class="form-input">
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="isNewTypeCheckbox">
                            Nuovo Tipo
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="marca">Marca/Modello:</label>
                        <input type="text" id="marca" name="marca" required 
                               placeholder="Es: Fluke 87V">
                    </div>

                    <div class="form-group">
                        <label for="ubicazione">Ubicazione:</label>
                        <div class="select-with-add" id="existingLocationDiv">
                            <select id="ubicazione" name="ubicazione" class="form-select" required>
                                <option value="">Seleziona ubicazione...</option>
                            </select>
                        </div>
                        <input type="text" id="newLocationInput" name="newLocation"
                               style="display: none; text-transform: uppercase;"
                               placeholder="Inserisci nuova ubicazione"
                               class="form-input">
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="isNewLocationCheckbox">
                            Nuova Ubicazione
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="userName">Nome Utente:</label>
                        <input type="text" id="userName" name="userName" required 
                               style="text-transform: uppercase;" 
                               placeholder="Es: MARIO ROSSI">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Salva</button>
                        <button type="button" class="btn-secondary" id="newEquipmentCancel">Annulla</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p id="loadingMessage">Caricamento in corso...</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>