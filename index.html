<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SERES - Archivio Attrezzature</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header">
        <button class="menu-toggle" id="menuToggle">☰</button>
        <h1>🔧 SERES - Archivio Attrezzature</h1>
        <div class="search-section">
            <span class="search-text" id="searchText">Ricerca</span>
            <button class="search-icon" id="searchToggle">🔍</button>
        </div>
    </div>

    <!-- Search Overlay -->
    <div class="search-overlay" id="searchOverlay">
        <div class="search-container">
            <div class="search-header">
                <h3>🔍 Ricerca Attrezzature</h3>
                <button class="search-close" id="searchClose">✕</button>
            </div>
            <input type="text" class="search-bar" id="searchInput" placeholder="Cerca per codice, tipo, marca o ubicazione..." style="margin-bottom: 0;">
        </div>
    </div>

    <!-- Menu Slide -->
    <div class="menu-overlay" id="menuOverlay"></div>
    <div class="slide-menu" id="slideMenu">
        <div class="menu-header">
            <h3>Menu</h3>
            <button class="menu-close" id="menuClose">✕</button>
        </div>        <div class="menu-content">
            <h4 style="margin: 25px 0 15px; color: #333;">⚙️ Azioni</h4>
            <button class="menu-item" id="btnAddEquipment">
                🛠️ Nuova Attrezzatura
            </button>
            <button class="menu-item" id="btnRefresh">
                🔄 Aggiorna Dati
            </button>
            <h4 style="margin: 25px 0 15px; color: #333;">ℹ️ Info</h4>
            <button class="menu-item" id="btnAbout">
                📖 Guida all'uso
            </button>
        </div>
    </div>

    <!-- About Modal -->
    <div class="about-modal" id="aboutModal">
        <button class="about-close" id="aboutClose">✕</button>
        <h2>📱 Gestione Attrezzature SERES</h2>
        
        <h3>🎯 Scopo dell'applicazione</h3>
        <p>Questa applicazione permette di gestire e tracciare tutte le attrezzature SERES, mantenendo uno storico dei movimenti e facilitando la ricerca degli strumenti.</p>

        <h3>🔍 Come utilizzare l'app</h3>
        <ul>
            <li><strong>Visualizzazione:</strong> È possibile visualizzare le attrezzature per ubicazione, categoria o tipo utilizzando il menu in alto.</li>
            <li><strong>Ricerca:</strong> Usa la barra di ricerca per trovare rapidamente un'attrezzatura specifica. La ricerca funziona su codice, tipo, marca/modello, ubicazione e categoria.</li>
            <li><strong>Dettagli:</strong> Clicca su un'attrezzatura per vedere tutti i dettagli e lo storico dei movimenti.</li>
            <li><strong>Spostamenti:</strong> Nella vista dettaglio, puoi registrare lo spostamento di un'attrezzatura in una nuova ubicazione.</li>
        </ul>        <h3>➕ Gestione dati</h3>
        <ul>
            <li><strong>Nuova Ubicazione:</strong> Puoi aggiungere una nuova ubicazione durante lo spostamento di un'attrezzatura.</li>
            <li><strong>Nuova Attrezzatura:</strong> Registra una nuova attrezzatura nel sistema.</li>
            <li><strong>Aggiorna Dati:</strong> Sincronizza i dati con il foglio Google Sheets.</li>
        </ul>

        <h3>💡 Suggerimenti</h3>
        <ul>
            <li>Usa il pulsante di ricerca per filtrare rapidamente le attrezzature.</li>
            <li>Controlla sempre l'ubicazione attuale prima di cercare un'attrezzatura.</li>
            <li>Registra sempre i movimenti delle attrezzature per mantenere uno storico accurato.</li>
        </ul>
    </div>
    
    <div class="container">
        <div class="view-content" id="viewContent">
            <div class="loading">
                <p>🔄 Caricamento dati da Google Sheets...</p>
                <div style="margin-top: 20px;">
                    <div style="width: 100%; background: #e0e0e0; border-radius: 10px; overflow: hidden;">
                        <div id="loadingBar" style="width: 0%; height: 4px; background: #8B2E1A; transition: width 0.3s ease;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-item active" id="navUbicazione" data-view="ubicazione">
            <div class="nav-icon">📍</div>
            <div class="nav-label">Ubicazione</div>
        </button>
        <button class="nav-item" id="navCategoria" data-view="categoria">
            <div class="nav-icon">📂</div>
            <div class="nav-label">Categoria</div>
        </button>
        <button class="nav-item" id="navTipo" data-view="tipo">
            <div class="nav-icon">🔧</div>
            <div class="nav-label">Tipo</div>
        </button>
    </div>

    <!-- Modal Dettaglio Attrezzatura -->
    <div id="detailModal" class="modal">
        <div class="modal-content detail-modal">
            <div class="modal-header">
                <h2>Dettaglio Attrezzatura</h2>
                <button class="modal-close" id="closeDetailModal">✕</button>
            </div>
            
            <!-- Info Principali -->
            <div class="detail-section">
                <div class="detail-info">
                    <div class="info-group">
                        <label>Codice:</label>
                        <span id="detailCodice"></span>
                    </div>
                    <div class="info-group">
                        <label>Categoria:</label>
                        <span id="detailCategoria"></span>
                    </div>
                    <div class="info-group">
                        <label>Tipo:</label>
                        <span id="detailTipo"></span>
                    </div>
                    <div class="info-group">
                        <label>Marca/Modello:</label>
                        <span id="detailMarca"></span>
                    </div>
                    <div class="info-group">
                        <label>Ubicazione Attuale:</label>
                        <span id="detailUbicazione"></span>
                    </div>
                </div>
            </div>

            <!-- Form Note e Link -->
            <div class="detail-section edit-section">
                <h3>Note e Documentazione</h3>
                <form id="updateNotesForm" class="detail-form">
                    <div class="form-group">
                        <label for="detailNote">Note:</label>
                        <textarea id="detailNote" rows="3" placeholder="Aggiungi note sull'attrezzatura..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="detailDoc">Link Documentazione:</label>
                        <div class="doc-input-group">
                            <input type="url" id="detailDoc" placeholder="https://...">
                            <button type="button" id="openDocButton" class="secondary-button" title="Apri link">🔗</button>
                        </div>
                        <small class="form-hint">Link a manuali, schede tecniche o altra documentazione</small>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="primary-button">💾 Salva Modifiche</button>
                    </div>
                </form>
            </div>

            <!-- Sezione Spostamento -->
            <div class="detail-section move-section">
                <h3>Sposta Attrezzatura</h3>
                <form id="moveForm" class="detail-form">
                    <input type="hidden" id="currentLocation">
                    <div class="form-group">
                        <label for="newLocation">Nuova Ubicazione:</label>
                        <div class="select-with-add">
                            <select id="newLocation" required>
                                <option value="">Seleziona ubicazione...</option>
                            </select>
                            <button type="button" class="add-option" data-target="newLocation">+</button>
                        </div>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="isNewLocationCheckbox">
                            Nuova Ubicazione
                        </label>
                    </div>
                    <div class="form-actions">
                        <button type="submit" id="moveEquipmentBtn" class="primary-button">📦 Sposta</button>
                    </div>
                </form>
            </div>

            <!-- Storico Movimenti -->
            <div class="detail-section history-section">
                <h3>Storico Movimenti</h3>
                <div id="movementHistory" class="movement-list">
                    <!-- Lo storico verrà popolato dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p id="loadingMessage">Spostamento in corso...</p>
        </div>
    </div>
    <!-- All content divs -->
    </div>

    <script src="script.js"></script>
</body>
</html>